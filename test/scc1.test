/* SCC test of a graph with a long cycle,
originated from the model (where the matching
is indicated with comments for each equation):

model scc1
  constant Integer N = 100000;
  Real a[N], b;
equation
  for i in 1:N-1 loop
    a[i] + a[i+1] = 0; // a[1:N-1]
  end for;
  a[N] + b = 0; // a[N]
  a[1] + b = 0; // b
end scc1;
*/

N = 100000

V1 = N
V2 = 1+V1

E1 = N-1
E2 = 1+E1
E3 = 1+E2

off1b = r(V1, 1)-E1-1
off2b = r(V1, 1)-E2
off3b = r(V2, 1)-E3

off1d = r(V1, 1)-E1
off2d = r(V2, 1)-E2
off3d = r(V1, 1)-E3-N+1

V %= {[1:1:V1], [V1+1:1:V2]};
Vmap %= <<{[1:1:V1]} -> 0*x+1, {[V1+1:1:V2]} -> 0*x+2>>; 
mapB %= <<{[1:1:E1]} -> 1*x+off1b, {[E1+1:1:E2]} -> 1*x+off2b, {[E2+1:1:E3]} -> 1*x+off3b>>;
mapD %= <<{[1:1:E1]} -> 1*x+off1d, {[E1+1:1:E2]} -> 1*x+off2d, {[E2+1:1:E3]} -> 1*x+off3d>>;
Emap %= <<{[1:1:E1]} -> 0*x+1, {[E1+1:1:E2]} -> 0*x+2, {[E2+1:1:E3]} -> 0*x+3>>;

scc(
V %= {[1:1:V1], [V1+1:1:V2]};
Vmap %= <<{[1:1:V1]} -> 0*x+1, {[V1+1:1:V2]} -> 0*x+2>>; 
mapB %= <<{[1:1:E1]} -> 1*x+off1b, {[E1+1:1:E2]} -> 1*x+off2b, {[E2+1:1:E3]} -> 1*x+off3b>>;
mapD %= <<{[1:1:E1]} -> 1*x+off1d, {[E1+1:1:E2]} -> 1*x+off2d, {[E2+1:1:E3]} -> 1*x+off3d>>;
Emap %= <<{[1:1:E1]} -> 0*x+1, {[E1+1:1:E2]} -> 0*x+2, {[E2+1:1:E3]} -> 0*x+3>>;
)
