// SCC test of the RC circuit example

N = 100

FU11 = 1
FU21 = N-1+FU11
FU22 = 1+FU21
FU33 = N+FU22
FU42 = N-1+FU33
FU54 = N-1+FU42
FU64 = 1+FU54

E1 = N-1 // FU21 - FU42
E2 = 1+E1 // FU22 - FU11
E3 = 1+E2 // FU33 - FU11
E4 = N-1+E3 // FU33 - FU21
E5 = N-1+E4 // FU42 - FU33
E6 = 1+E5 // FU54 - FU11
E7 = N-2+E6 // FU54 - FU21
E8 = 1+E7 // FU64 - FU21

off1b = r(FU21, 1)-r(E1, 1)
off2b = r(FU22, 1)-r(E2, 1)
off3b = r(FU33, 1)-r(E3, 1)-N+1
off4b = r(FU33, 1)-r(E4, 1)
off5b = r(FU42, 1)-r(E5, 1)
off6b = r(FU54, 1)-r(E6, 1)-N+2
off7b = r(FU54, 1)-r(E7, 1)
off8b = r(FU64, 1)-r(E8, 1)

off1d = r(FU42, 1)-r(E1, 1)
off2d = r(FU11, 1)-r(E2, 1)
off3d = r(FU11, 1)-r(E3, 1)
off4d = r(FU21, 1)-r(E4, 1)
off5d = r(FU33, 1)-r(E5, 1)
off6d = r(FU11, 1)-r(E6, 1)
off7d = r(FU21, 1)-r(E7, 1)-1
off8d = r(FU21, 1)-r(E8, 1)

V %= {[1:1:FU11], [FU11+1:1:FU21], [FU21+1:1:FU22], [FU22+1:1:FU33]
  , [FU33+1:1:FU42], [FU42+1:1:FU54], [FU54+1:1:FU64]};
Vmap %= <<{[1:1:FU11]} -> 0*x+1, {[FU11+1:1:FU21]} -> 0*x+2, {[FU21+1:1:FU22]} -> 0*x+3
  , {[FU22+1:1:FU33]} -> 0*x+4 , {[FU33+1:1:FU42]} -> 0*x+5
  , {[FU42+1:1:FU54]} -> 0*x+6, {[FU54+1:1:FU64]} -> 0*x+7>>;
mapB %= <<{[1:1:E1]} -> 1*x+off1b, {[E1+1:1:E2]} -> 1*x+off2b, {[E2+1:1:E3]} -> 1*x+off3b
  , {[E3+1:1:E4]} -> 1*x+off4b, {[E4+1:1:E5]} -> 1*x+off5b, {[E5+1:1:E6]} -> 1*x+off6b
  , {[E6+1:1:E7]} -> 1*x+off7b, {[E7+1:1:E8]} -> 1*x+off8b>>;
mapD %= <<{[1:1:E1]} -> 1*x+off1d, {[E1+1:1:E2]} -> 1*x+off2d, {[E2+1:1:E3]} -> 1*x+off3d
  , {[E3+1:1:E4]} -> 1*x+off4d, {[E4+1:1:E5]} -> 1*x+off5d, {[E5+1:1:E6]} -> 1*x+off6d
  , {[E6+1:1:E7]} -> 1*x+off7d, {[E7+1:1:E8]} -> 1*x+off8d>>;
Emap %= <<{[1:1:E1]} -> 0*x+1, {[E1+1:1:E2]} -> 0*x+2, {[E2+1:1:E3]} -> 0*x+3
  , {[E3+1:1:E4]} -> 0*x+4, {[E4+1:1:E5]} -> 0*x+5, {[E5+1:1:E6]} -> 0*x+6
  , {[E6+1:1:E7]} -> 0*x+7, {[E7+1:1:E8]} -> 0*x+8>>;

scc(
  V %= {[1:1:FU11], [FU11+1:1:FU21], [FU21+1:1:FU22], [FU22+1:1:FU33]
    , [FU33+1:1:FU42], [FU42+1:1:FU54], [FU54+1:1:FU64]};
  Vmap %= <<{[1:1:FU11]} -> 0*x+1, {[FU11+1:1:FU21]} -> 0*x+2, {[FU21+1:1:FU22]} -> 0*x+3
    , {[FU22+1:1:FU33]} -> 0*x+4 , {[FU33+1:1:FU42]} -> 0*x+5
    , {[FU42+1:1:FU54]} -> 0*x+6, {[FU54+1:1:FU64]} -> 0*x+7>>;
  mapB %= <<{[1:1:E1]} -> 1*x+off1b, {[E1+1:1:E2]} -> 1*x+off2b, {[E2+1:1:E3]} -> 1*x+off3b
    , {[E3+1:1:E4]} -> 1*x+off4b, {[E4+1:1:E5]} -> 1*x+off5b, {[E5+1:1:E6]} -> 1*x+off6b
    , {[E6+1:1:E7]} -> 1*x+off7b, {[E7+1:1:E8]} -> 1*x+off8b>>;
  mapD %= <<{[1:1:E1]} -> 1*x+off1d, {[E1+1:1:E2]} -> 1*x+off2d, {[E2+1:1:E3]} -> 1*x+off3d
    , {[E3+1:1:E4]} -> 1*x+off4d, {[E4+1:1:E5]} -> 1*x+off5d, {[E5+1:1:E6]} -> 1*x+off6d
    , {[E6+1:1:E7]} -> 1*x+off7d, {[E7+1:1:E8]} -> 1*x+off8d>>;
  Emap %= <<{[1:1:E1]} -> 0*x+1, {[E1+1:1:E2]} -> 0*x+2, {[E2+1:1:E3]} -> 0*x+3
    , {[E3+1:1:E4]} -> 0*x+4, {[E4+1:1:E5]} -> 0*x+5, {[E5+1:1:E6]} -> 0*x+6
    , {[E6+1:1:E7]} -> 0*x+7, {[E7+1:1:E8]} -> 0*x+8>>;
)
